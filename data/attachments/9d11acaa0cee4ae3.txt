// PRE-REQUEST SCRIPT:
const getAvailablePetsRequest = {
    url: 'https://petstore.swagger.io/v2/pet/findByStatus?status=available',
    method: 'GET',
    header: {
        'accept': 'application/json'
    }
};


async function setPetId() {
    try {
        const response = await pm.sendRequest(getAvailablePetsRequest);
        const pets = response.json();
        
        if (!pets || pets.length === 0) {
            console.error("No se encontraron mascotas disponibles");
            return;
        }
        
        
        const petId = pets[0].id;
        pm.environment.set("petId", petId);
        console.log("ID de mascota guardado:", petId);
        
        
        pm.request.url.path = `/v2/pet/${petId}`;
        
    } catch (error) {
        console.error("Error en pre-request:", error);
    }
}

setPetId();